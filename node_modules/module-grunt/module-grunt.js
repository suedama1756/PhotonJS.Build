var _build = require('module-build');

module.exports = function(grunt) {
    // Create a new task.
    grunt.registerMultiTask('module', 'Build module source files', function() {
        if (!this.target) {
            return;
        }

        var data = this.data, moduleFiles = data && data.jsm;
        if (!moduleFiles) {
           grunt.log.warn('No jsm specified for module task');
        }

        if (!Array.isArray(moduleFiles)) {
            moduleFiles = [moduleFiles];
        }

        var builder = new _build.ModuleBuilder(data.options);
        moduleFiles.forEach(function(moduleFile) {
            builder.buildFile(moduleFile);
        });
    });
};